# AOF

## 정의

AOF는 Redis에서 사용되는 데이터의 영속성을 보장하기 위한 방법 중 하나로, "Append-Only File"의 약어다. AOF는 Redis 서버에 수행된 모든 쓰기 작업(Write Operations)을 기록하고, 이를 파일에 append(추가)하여 저장하는 메커니즘을 말한다.

## 작동 원리

1. **명령 기록:** Redis는 수행된 각 쓰기 명령을 AOF 파일에 기록합니다. 이 명령들은 사람이 읽을 수 있는 텍스트 형식으로 저장되며, 명령이 Redis 서버에 수행되면 해당 명령이 AOF 파일에 추가됩니다.
2. **추가만 가능 (Append-Only):** AOF 파일은 항상 추가 모드로 열려 있어야 합니다. 이는 새로운 명령이 계속해서 기존 파일 끝에 추가되는 방식을 의미합니다. 파일 내용이 변경되는 것이 아니라(Put 이 아님) 기존 내용에 명령이 계속해서 추가됩니다.
3. **재실행 가능 (Rewriting):** AOF 파일의 크기가 너무 커지면 Redis는 주기적으로 AOF 파일을 재작성합니다. 재작성은 AOF 파일의 내용을 최적화하고, 더 작은 크기로 압축하여 디스크 공간을 절약하며, 읽기와 쓰기 성능을 향상시킵니다.
4. **재실행을 통한 복구: 레디스** 서버가 다시 시작될 때, Redis는 AOF 파일의 내용을 읽어와 명령을 다시 실행하여 데이터를 메모리에 복구합니다. 이를 통해 Redis는 비정상 종료 시에도 데이터의 일관성을 유지할 수 있습니다.

## 장점

AOF의 주요 장점은 데이터의 지속성과 복구 기능을 제공한다는 점입니다. 그러나 AOF 파일이 커지면 디스크 공간을 많이 차지할 수 있으며, 주기적인 재작성이 필요할 수 있습니다.

AWS 사용자는 AOF와 RDB (Snapshotting)를 조합하여 사용하기도 합니다.
